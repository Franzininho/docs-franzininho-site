"use strict";(self.webpackChunkFranzininho=self.webpackChunkFranzininho||[]).push([[1392],{6567:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>t,metadata:()=>s,toc:()=>c});var o=n(17624),i=n(95788);const t={id:"timer0-int",title:"Timer 0 - Interrup\xe7\xe3o",slug:"/franzininho-diy/exemplos-avr-libc/timer0-int",description:"Vamos aprender usar o timer 0 como temporizador e usando sua interrup\xe7\xe3o",authors:"F\xe1bio Souza",date:"24/04/2021",some_url:"https://github.com/FBSeletronica"},a=void 0,s={id:"FranzininhoDIY/exemplos-avr-libc/timer0-int",title:"Timer 0 - Interrup\xe7\xe3o",description:"Vamos aprender usar o timer 0 como temporizador e usando sua interrup\xe7\xe3o",source:"@site/docs/FranzininhoDIY/exemplos-avr-libc/timer0-int.md",sourceDirName:"FranzininhoDIY/exemplos-avr-libc",slug:"/franzininho-diy/exemplos-avr-libc/timer0-int",permalink:"/docs/franzininho-diy/exemplos-avr-libc/timer0-int",draft:!1,unlisted:!1,editUrl:"https://github.com/Franzininho/docs-franzininho-site/edit/main/docs/FranzininhoDIY/exemplos-avr-libc/timer0-int.md",tags:[],version:"current",frontMatter:{id:"timer0-int",title:"Timer 0 - Interrup\xe7\xe3o",slug:"/franzininho-diy/exemplos-avr-libc/timer0-int",description:"Vamos aprender usar o timer 0 como temporizador e usando sua interrup\xe7\xe3o",authors:"F\xe1bio Souza",date:"24/04/2021",some_url:"https://github.com/FBSeletronica"},sidebar:"docs",previous:{title:"Timer 0",permalink:"/docs/franzininho-diy/exemplos-avr-libc/timer0"},next:{title:"Contador de pulsos externos",permalink:"/docs/franzininho-diy/exemplos-avr-libc/contadores"}},l={},c=[{value:"Interrup\xe7\xe3o do Timer0",id:"interrup\xe7\xe3o-do-timer0",level:2},{value:"Usando o Timer0 como temporizador com sua interrup\xe7\xe3o",id:"usando-o-timer0-como-temporizador-com-sua-interrup\xe7\xe3o",level:2},{value:"Recursos necess\xe1rios",id:"recursos-necess\xe1rios",level:3},{value:"C\xf3digo exemplo",id:"c\xf3digo-exemplo",level:3},{value:"Simula\xe7\xe3o do exemplo",id:"simula\xe7\xe3o-do-exemplo",level:3}];function d(e){const r={admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.MN)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.p,{children:"Nesse exemplo vamos entender como usar a interrup\xe7\xe3o do Timer0 para verificar o seu overflow. Dessa forma n\xe3o precisaremos ficar monitorando o flag de overflow no loop principal da aplica\xe7\xe3o."}),"\n",(0,o.jsx)(r.h2,{id:"interrup\xe7\xe3o-do-timer0",children:"Interrup\xe7\xe3o do Timer0"}),"\n",(0,o.jsx)(r.p,{children:"No exemplo anterior configuramos o Timer0 para operar no modo  normal. Para monitora a sua contagem monitoramos o flag TOV0  dentro do loop. Como o Timer \xe9 um perif\xe9rico que funciona independente  da CPU podemos habilitar a sua contagem e verificar o overflow atrav\xe9s  da sua interrup\xe7\xe3o."}),"\n",(0,o.jsxs)(r.p,{children:["Para habilitar a interrup\xe7\xe3o do Timer0 devermos colocar 1 no bit ",(0,o.jsx)(r.strong,{children:"TOIE0"})," no registrador ",(0,o.jsx)(r.strong,{children:"TIMSK"}),":"]}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{alt:"TIMSK",src:n(62336).c+"",width:"836",height:"158"})}),"\n",(0,o.jsx)(r.p,{children:"Ap\xf3s isso, para que a interrup\xe7\xe3o realmente ocorra, devemos habilitar a chave global de interrup\xe7\xe3o atrav\xe9s da fun\xe7\xe3o sei();"}),"\n",(0,o.jsx)(r.h2,{id:"usando-o-timer0-como-temporizador-com-sua-interrup\xe7\xe3o",children:"Usando o Timer0 como temporizador com sua interrup\xe7\xe3o"}),"\n",(0,o.jsx)(r.p,{children:"Vamos  fazer a mesma aplica\xe7\xe3o do exemplo anterior, que \xe9 inverter o estado lo  LED em intervalos de 1 s. A diferen\xe7a aqui \xe9 que vamos monitorar os  overflows do timer atrav\xe9s da rotina de interrup\xe7\xe3o."}),"\n",(0,o.jsx)(r.p,{children:"A configura\xe7\xe3o do timer segue a mesma, j\xe1 que queremos gerar um delay de 1 segundo."}),"\n",(0,o.jsx)(r.p,{children:"Assim, precisaremos contar a quantidade de interrup\xe7\xf5es e quando atingir 63, inverteremos o estado do LED."}),"\n",(0,o.jsx)(r.h3,{id:"recursos-necess\xe1rios",children:"Recursos necess\xe1rios"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Placa Franzininho DIY(com Micronucleus);"}),"\n",(0,o.jsx)(r.li,{children:"LED;"}),"\n",(0,o.jsx)(r.li,{children:"Resistor de 470 Ohm;"}),"\n",(0,o.jsx)(r.li,{children:"Jumpers;"}),"\n",(0,o.jsx)(r.li,{children:"Computador com as ferramentas de software instaladas."}),"\n"]}),"\n",(0,o.jsx)(r.h3,{id:"c\xf3digo-exemplo",children:"C\xf3digo exemplo"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-c",children:'/**\n * \n * @file main.c\n * @author F\xe1bio Souza\n * @brief Exibe como usar a interrup\xe7\xe3o do timer 0 para temporiza\xe7\xe3o\n * @version 0.1\n * @date 2021-02-13\n * \n * @copyright Franzininho \n * This example code is in the Public Domain (or CC0 licensed, at your option.)\n * Unless required by applicable law or agreed to in writing, this\n * software is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied.\n * \n */\n\n#include <avr/io.h>\n#include <util/delay.h> \n#include <avr/interrupt.h>\n\n#define F_CPU 16500000L\n\n \t\n#define setBit(valor,bit) (valor |= (1<<bit))\n#define clearBit(valor,bit) (valor &= ~(1<<bit))\n#define toogleBit(valor,bit) (valor ^= (1<<bit))\n#define testBit(valor,bit)    (valor & (1<<bit))\n\nunsigned char tempo = 0;  //contador auxiliar\n\n\nISR (TIMER0_OVF_vect) //vetor de interrup\xe7\xe3o para o timer 0\n{\n  tempo++;                     //incrementa contador auxiliar\n  if(tempo >=63)               //se passaram-se 63 x 15,89 ms = 1 s\n  {\n    toogleBit(PORTB,PB1);      //inverte LED\n    tempo = 0;                 //reinicia contador\n  }\n}\n\n/**\n * @brief Fun\xe7\xe3o main\n * \n * @return int \n */\nint main(void) \n{\n  \n  setBit(DDRB,PB1); \t// Configura Pino PB1 como sa\xedda (Pino do LED)\n\n  //configura\xe7\xe3o do timer0 para overflow a aproximadamente 15,89 ms\n  //t = (1/16.5Mhz) x 1024 x 256 = 15,89 ms\n  TCCR0A=0x00;                      //Modo Normal\n  TCCR0B=0x00;\n  TCCR0B |= (1<<CS00)|(1<<CS02);   //prescaler de 1024\n  TCNT0=0;                         //inicia timer com 0\n  setBit(TIMSK,TOIE0);             //habilita interrup\xe7\xe3o do timer0 \n  sei();                           //habilita interrup\xe7\xe3o global\n  \n  /**\n   * @brief loop infinito\n   * \n   */\n  while (1)\n  {\n      //n\xe3o faz nada no loop \n  }                                                \n  return (0);                           \n}\n'})}),"\n",(0,o.jsx)(r.admonition,{title:"Informa\xe7\xe3o",type:"note",children:(0,o.jsx)(r.p,{children:"Note que no loop principal n\xe3o fizemos nada. Todo o tratamento ficou na interrup\xe7\xe3o do Timer0."})}),"\n",(0,o.jsx)(r.h3,{id:"simula\xe7\xe3o-do-exemplo",children:"Simula\xe7\xe3o do exemplo"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"**Wokwi: **"}),"\n"]}),"\n",(0,o.jsx)("iframe",{width:"100%",height:"458px",src:"https://wokwi.com/arduino/projects/306143631949955648?view=diagram"})]})}function m(e={}){const{wrapper:r}={...(0,i.MN)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},95788:(e,r,n)=>{n.d(r,{MN:()=>c});var o=n(11504);function i(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function t(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(r){i(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function s(e,r){if(null==e)return{};var n,o,i=function(e,r){if(null==e)return{};var n,o,i={},t=Object.keys(e);for(o=0;o<t.length;o++)n=t[o],r.indexOf(n)>=0||(i[n]=e[n]);return i}(e,r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(o=0;o<t.length;o++)n=t[o],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=o.createContext({}),c=function(e){var r=o.useContext(l),n=r;return e&&(n="function"==typeof e?e(r):a(a({},r),e)),n},d={inlineCode:"code",wrapper:function(e){var r=e.children;return o.createElement(o.Fragment,{},r)}},m=o.forwardRef((function(e,r){var n=e.components,i=e.mdxType,t=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),p=c(n),u=i,h=p["".concat(l,".").concat(u)]||p[u]||d[u]||t;return n?o.createElement(h,a(a({ref:r},m),{},{components:n})):o.createElement(h,a({ref:r},m))}));m.displayName="MDXCreateElement"},62336:(e,r,n)=>{n.d(r,{c:()=>o});const o=n.p+"assets/images/TIMSK-a059550570192a069297e5ea900b71ef.png"}}]);