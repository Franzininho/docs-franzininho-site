"use strict";(self.webpackChunkFranzininho=self.webpackChunkFranzininho||[]).push([[404],{57584:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>d,contentTitle:()=>s,default:()=>m,frontMatter:()=>n,metadata:()=>t,toc:()=>c});var o=r(17624),i=r(4552);const n={id:"micropython-registro-temperatura",title:"Sistema de Registro de Temperatura",slug:"/franzininho-wifi/exemplos-micropython/registro-temperatura",description:"Neste artigo veremos como registrar os dados coletados pelo DHT11 presente na placa Franzininho WiFi Lab01, utilizando um sistema que permite criar, gravar e ler arquivos.",author:"Sthefania Fernandes"},s=void 0,t={id:"FranzininhoWifi/exemplos-micropython/micropython-registro-temperatura",title:"Sistema de Registro de Temperatura",description:"Neste artigo veremos como registrar os dados coletados pelo DHT11 presente na placa Franzininho WiFi Lab01, utilizando um sistema que permite criar, gravar e ler arquivos.",source:"@site/docs/FranzininhoWifi/exemplos-micropython/registro-temperatura.md",sourceDirName:"FranzininhoWifi/exemplos-micropython",slug:"/franzininho-wifi/exemplos-micropython/registro-temperatura",permalink:"/docs/franzininho-wifi/exemplos-micropython/registro-temperatura",draft:!1,unlisted:!1,editUrl:"https://github.com/Franzininho/docs-franzininho-site/edit/main/docs/FranzininhoWifi/exemplos-micropython/registro-temperatura.md",tags:[],version:"current",frontMatter:{id:"micropython-registro-temperatura",title:"Sistema de Registro de Temperatura",slug:"/franzininho-wifi/exemplos-micropython/registro-temperatura",description:"Neste artigo veremos como registrar os dados coletados pelo DHT11 presente na placa Franzininho WiFi Lab01, utilizando um sistema que permite criar, gravar e ler arquivos.",author:"Sthefania Fernandes"},sidebar:"docs",previous:{title:"Fotoc\xe9lula",permalink:"/docs/franzininho-wifi/exemplos-micropython/rgb-ldr"},next:{title:"Placa Franzininho WiFi dev Edition",permalink:"/docs/franzininho-wifi/franzininho-wifi-dev-edition"}},d={},c=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Sistema de arquivos",id:"sistema-de-arquivos",level:2},{value:"Recursos necess\xe1rios",id:"recursos-necess\xe1rios",level:2},{value:"C\xf3digo",id:"c\xf3digo",level:2},{value:"Explica\xe7\xe3o do c\xf3digo",id:"explica\xe7\xe3o-do-c\xf3digo",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2}];function l(e){const a={code:"code",em:"em",h2:"h2",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.M)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,o.jsx)(a.p,{children:"Quando configuramos um sensor para coletar dados, \xe9 importante garantir que essas informa\xe7\xf5es sejam devidamente registradas e armazenadas para uso posterior."}),"\n",(0,o.jsx)(a.p,{children:"Neste artigo veremos como registrar os dados coletados pelo DHT11 presente na placa Franzininho WiFi Lab01, utilizando um sistema que permite criar, gravar e ler arquivos."}),"\n",(0,o.jsx)(a.h2,{id:"sistema-de-arquivos",children:"Sistema de arquivos"}),"\n",(0,o.jsx)(a.p,{children:"O sistema de arquivos \xe9 onde a sua placa armazena todos os programas que voc\xea escreveu. Ele \xe9 uma forma de armazenamento n\xe3o vol\xe1til, o que significa que tudo o que voc\xea salvar l\xe1 permanece mesmo quando voc\xea desconectar o cabo micro USB da Franzininho WiFi Lab01."}),"\n",(0,o.jsx)(a.p,{children:"Para entender isso, conecte a sua Franzininho WiFi Lab01 ao computador e abra o Thonny. Agora, voc\xea n\xe3o ir\xe1 abrir nenhum programa, ent\xe3o clique na parte inferior da \xe1rea do Terminal para come\xe7ar a trabalhar com a sua placa em modo interativo e digite:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'file  =  open("test.txt",  "w")\n'})}),"\n",(0,o.jsx)(a.p,{children:"Isso instrui o MicroPython a abrir um arquivo chamado \u201ctest.txt\u201d para realizar uma escrita (\u201cw\u201d \xe9 a instru\xe7\xe3o de escrita). No momento o arquivo foi aberto mas n\xe3o h\xe1 nada nele, ent\xe3o digite:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'file.write("Ol\xe1, Franzininho!")\n'})}),"\n",(0,o.jsx)(a.p,{children:"Ao pressionar o ENTER no final desta linha, voc\xea ver\xe1 o n\xfamero 18 aparecer como retorno do comando. Isso \xe9 o MicroPython confirmando que ele escreveu 18 bytes no arquivo que voc\xea abriu. Conte o n\xfamero de caracteres na mensagem que voc\xea escreveu: incluindo as letras, acento, v\xedrgula, espa\xe7o e ponto de exclama\xe7\xe3o, h\xe1 18 \u2013 cada um dos quais ocupa um byte."}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'>>>  file  =  open("test.txt",  "w")\n>>>  file.write("Ol\xe1, Franzininho!")\n18\n>>>\n'})}),"\n",(0,o.jsx)(a.p,{children:"Quando escrevemos um arquivo, \xe9 preciso fech\xe1-lo \u2014 isso garante que os dados que voc\xea informou ao MicroPython para escrever sejam realmente gravados no sistema de arquivos. Se voc\xea n\xe3o fechar o arquivo, os dados podem n\xe3o ser gravados."}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:"file.close()\n"})}),"\n",(0,o.jsx)(a.p,{children:"Agora o arquivo est\xe1 armazenado com seguran\xe7a no sistema de arquivos da sua Franzininho WiFi Lab01."}),"\n",(0,o.jsx)(a.p,{children:"Uma forma de verificar \xe9 clicando no \xedcone \u201cAbrir\u201d na barra de ferramentas do Thonny, depois clicar em \u201cdispositivo MicroPython\u201d, rolar pela lista de arquivos at\xe9 encontrar test.txt. Clique no arquivo e, em seguida, clique em OK para abri-lo: voc\xea ver\xe1 sua mensagem aparecer em uma nova guia do Thonny."}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{src:r(32576).c+"",width:"1600",height:"914"})}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{src:r(90200).c+"",width:"1600",height:"914"})}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{src:r(68520).c+"",width:"1600",height:"914"})}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{src:r(99928).c+"",width:"1600",height:"914"})}),"\n",(0,o.jsx)(a.p,{children:"H\xe1 outra forma para ler arquivos \u2014 voc\xea pode realizar essa tarefa utilizando o MicroPython. Novamente, clique na parte inferior da \xe1rea do Terminal e insira o seguinte comando:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'file  =  open("test.txt")\n'})}),"\n",(0,o.jsxs)(a.p,{children:["Voc\xea poderia digitar ",(0,o.jsx)(a.code,{children:"open(\u201ctest.txt\u201d, \u201cr\u201d)"})," mas o MicroPython abre um arquivo em modo de leitura por padr\xe3o \u2013 ent\xe3o est\xe1 tudo bem deixar essa parte da instru\xe7\xe3o de fora. Em seguida, digite:"]}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:"file.read()\n"})}),"\n",(0,o.jsx)(a.p,{children:"Assim voc\xea ver\xe1 a mensagem que voc\xea escreveu no arquivo ser exibida na \xe1rea do Terminal. Observe que dessa forma o uso de acentos pode imprimir uma coisa estranha ao inv\xe9s do \u201col\xe1\u201d armazenado, por isso recomenda-se evitar o uso de acentos."}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:">>>  file  =  open(\"test.txt\")\n>>>  file.read()\n'Ol\\xe1, Franzininho!'\n"})}),"\n",(0,o.jsx)(a.p,{children:"Na leitura n\xe3o \xe9 t\xe3o importante quanto na escrita fechar, mas \xe9 uma boa pr\xe1tica, ent\xe3o recomenda-se que sempre o fa\xe7a. Ent\xe3o digite:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:"file.close()\n"})}),"\n",(0,o.jsx)(a.h2,{id:"recursos-necess\xe1rios",children:"Recursos necess\xe1rios"}),"\n",(0,o.jsx)(a.p,{children:"Para iniciar o trabalho com os GPIOs, \xe9 essencial possuir o diagrama de pinos da placa \xe0 disposi\xe7\xe3o, pois isso vai permitir que voc\xea identifique tanto os nomes quanto as fun\xe7\xf5es associadas a cada um deles."}),"\n",(0,o.jsxs)(a.table,{children:[(0,o.jsx)(a.thead,{children:(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.th,{children:"Pino"}),(0,o.jsx)(a.th,{children:"Recurso"})]})}),(0,o.jsxs)(a.tbody,{children:[(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO1"}),(0,o.jsx)(a.td,{children:"LDR"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO2"}),(0,o.jsx)(a.td,{children:"BT6"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO3"}),(0,o.jsx)(a.td,{children:"BT5"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO4"}),(0,o.jsx)(a.td,{children:"BT4"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO5"}),(0,o.jsx)(a.td,{children:"BT3"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO6"}),(0,o.jsx)(a.td,{children:"BT2"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO7"}),(0,o.jsx)(a.td,{children:"BT1"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO8"}),(0,o.jsx)(a.td,{children:"OLED_SDA"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO9"}),(0,o.jsx)(a.td,{children:"OLED_SCL"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO10"}),(0,o.jsx)(a.td,{children:"TFT_DC"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO11"}),(0,o.jsx)(a.td,{children:"TFT_RES"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO12"}),(0,o.jsx)(a.td,{children:"LED AZUL"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO13"}),(0,o.jsx)(a.td,{children:"LED VERDE"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO14"}),(0,o.jsx)(a.td,{children:"LED VERMELHO"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO15"}),(0,o.jsx)(a.td,{children:"DHT11"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO17"}),(0,o.jsx)(a.td,{children:"BUZZER"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO35"}),(0,o.jsx)(a.td,{children:"TFT_SDA"})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"IO36"}),(0,o.jsx)(a.td,{children:"TFT_SCL"})]})]})]}),"\n",(0,o.jsx)(a.p,{children:"Tabela 1 \u2013 Franzininho WiFi Lab01 pinout"}),"\n",(0,o.jsx)(a.h2,{id:"c\xf3digo",children:"C\xf3digo"}),"\n",(0,o.jsx)(a.p,{children:"Agora que sabemos como abrir, escrever e ler arquivos, podemos construir um arquivo para guardar os registros de temperatura e umidade coletados pelo sensor DHT11. Assim, com a Franzininho WiFi Lab01 conectada ao seu computador, abra o Thonny e crie um novo arquivo contendo o c\xf3digo a seguir:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'import machine\nimport utime\nimport dht\n\nd = dht.DHT11(Pin(15))\nfile = open("temp.txt", "w")\n\nwhile True:\n\td.measure()\n\ttemperatura = d.temperature() # em \xb0C\n\tumidade= d.humidity() # em %\n    \n\ttemperatura_str="Temp: "+str(temperatura)+" \xbaC\\n"\n\tumidade_str="Umid: "+str(umidade)+" %\\n"\n   \n\tfile.write(temperatura_str)\n\tfile.write(umidade_str)\n    \n\tfile.flush()\n\tutime.sleep(10)\n'})}),"\n",(0,o.jsx)(a.h2,{id:"explica\xe7\xe3o-do-c\xf3digo",children:"Explica\xe7\xe3o do c\xf3digo"}),"\n",(0,o.jsx)(a.p,{children:"A configura\xe7\xe3o e coleta de dados do sensor DHT11, presente na Franzininho WiFi Lab01, foi explicada em detalhes no artigo \u201cMonitoramento de Temperatura e Umidade na Franzininho WiFi Lab01\u201d. Ent\xe3o vamos focar na escrita no arquivo .txt."}),"\n",(0,o.jsx)(a.p,{children:"Para organizar o arquivo, adicionamos \u201c+ \u201c\\n\u201d\u201d para que cada leitura do sensor seja armazenada em uma linha diferente, deixando o arquivo txt mais organizado."}),"\n",(0,o.jsx)(a.p,{children:"Um ponto importante a se observar \xe9 que n\xe3o vamos fechar o arquivo, isso porque n\xe3o poder\xedamos escrever nele novamente sem reabri-lo e apagar todo seu conte\xfado. Mas se o arquivo n\xe3o \xe9 fechado os dados n\xe3o s\xe3o salvos no sistema de arquivos."}),"\n",(0,o.jsx)(a.p,{children:"A solu\xe7\xe3o \xe9 esvaziar o arquivo, em vez de fech\xe1-lo, digitando:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:"file.flush()\n"})}),"\n",(0,o.jsx)(a.p,{children:"Quando estamos escrevendo em um arquivo e os dados n\xe3o est\xe3o sendo gravados no sistema de arquivos, eles s\xe3o armazenados em um buffer \u2013 uma \xe1rea de armazenamento tempor\xe1rio. Quando voc\xea fecha o arquivo, o buffer \xe9 gravado em um processo conhecido como \u201cesvaziamento\u201d (flushing). Usar \u201cfile.flush()\u201d \xe9 equivalente a \u201cfile.close()\u201d, no sentido de que esvazia o conte\xfado do buffer no arquivo. Mas ao contr\xe1rio de \u201cfile.close()\u201d, o arquivo permanece aberto para voc\xea gravar mais dados nele posteriormente."}),"\n",(0,o.jsx)(a.p,{children:"A leitura do sensor \xe9 feita a cada 10 segundos e o conte\xfado medido \xe9 guardado no arquivo \u201ctemp.txt\u201d."}),"\n",(0,o.jsx)(a.p,{children:"Agora, execute o programa e o deixe rodando por 1 minuto ou mais. No terminal, digite o seguinte c\xf3digo para abrir e ler o novo arquivo:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'file  =  open("temps.txt")\nprint(file.read())\n'})}),"\n",(0,o.jsx)(a.p,{children:"Dessa vez, colocamos o \u201cfile.read()\u201d dentro do \u201cprint\u201d isso porque utilizamos o \u201c\\n\u201d na escrita do arquivo e ele s\xf3 funciona como quebra de linha se utilizado no print."}),"\n",(0,o.jsx)(a.p,{children:"Ap\xf3s esperar alguns segundos, parei a execu\xe7\xe3o e acessei o arquivo. No Shell vemos a leitura da temperatura e umidade que a Franzininho WiFi Lab01 mediu e armazenou."}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:'>>> file = open("temp.txt")\n>>> print(file.read())\nTemp: 32 \xbaC\nUmid: 58 %\nTemp: 32 \xbaC\nUmid: 59 %\nTemp: 32 \xbaC\nUmid: 59 %\nTemp: 32 \xbaC\nUmid: 60 %\nTemp: 32 \xbaC\nUmid: 60 %\nTemp: 32 \xbaC\nUmid: 59 %\nTemp: 32 \xbaC\nUmid: 59 %\nTemp: 32 \xbaC\nUmid: 59 %\nTemp: 32 \xbaC\nUmid: 60 %\nTemp: 32 \xbaC\nUmid: 60 %\nTemp: 32 \xbaC\nUmid: 60 %\nTemp: 32 \xbaC\nUmid: 60 %\nTemp: 32 \xbaC\nUmid: 60 %\nTemp: 32 \xbaC\nUmid: 60 %\n'})}),"\n",(0,o.jsx)(a.p,{children:"Lembre-se: se n\xe3o fechar o arquivo esses dados ser\xe3o perdidos. Ent\xe3o ap\xf3s a leitura do arquivo, digite:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-python",children:"file.close()\n"})}),"\n",(0,o.jsx)(a.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,o.jsx)(a.p,{children:"O armazenamento adequado dos dados coletados por sensores, como o DHT11 para medi\xe7\xe3o de umidade e temperatura, garante a preserva\xe7\xe3o das informa\xe7\xf5es medidas e tamb\xe9m possibilita uma an\xe1lise posterior dos dados."}),"\n",(0,o.jsxs)(a.p,{children:["Neste artigo aprendemos como trabalhar com o sistema de arquivos na Franzininho WiFi Lab01 usando a linguagem MicroPython. A capacidade de criar, escrever e ler arquivos permitiu transformar a placa em um ",(0,o.jsx)(a.em,{children:"data logger"})," capaz de armazenar informa\xe7\xf5es importantes para uso subsequente."]}),"\n",(0,o.jsxs)(a.table,{children:[(0,o.jsx)(a.thead,{children:(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.th,{children:"Autor"}),(0,o.jsx)(a.th,{children:"Sthefania Fernandes"})]})}),(0,o.jsx)(a.tbody,{children:(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"Data:"}),(0,o.jsx)(a.td,{children:"04/01/2024"})]})})]})]})}function m(e={}){const{wrapper:a}={...(0,i.M)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},32576:(e,a,r)=>{r.d(a,{c:()=>o});const o=r.p+"assets/images/registro-temp-1-2ff5064e5db883d791bd1a13b34caba2.webp"},90200:(e,a,r)=>{r.d(a,{c:()=>o});const o=r.p+"assets/images/registro-temp-2-4347f802c99b5387d6d3da05ebceeac6.webp"},68520:(e,a,r)=>{r.d(a,{c:()=>o});const o=r.p+"assets/images/registro-temp-3-3727484876f1e11273ce736e95b4c970.webp"},99928:(e,a,r)=>{r.d(a,{c:()=>o});const o=r.p+"assets/images/registro-temp-4-e9b95e3980080f120dbcef14649aa0e0.webp"},4552:(e,a,r)=>{r.d(a,{I:()=>t,M:()=>s});var o=r(11504);const i={},n=o.createContext(i);function s(e){const a=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(n.Provider,{value:a},e.children)}}}]);