"use strict";(self.webpackChunkFranzininho=self.webpackChunkFranzininho||[]).push([[1576],{59724:(e,o,i)=>{i.r(o),i.d(o,{assets:()=>d,contentTitle:()=>r,default:()=>p,frontMatter:()=>n,metadata:()=>t,toc:()=>c});var s=i(17624),a=i(95788);const n={id:"saida-digital",title:"Sa\xedda Digital",slug:"/franzininho-diy/exemplos-avr-libc/saida-digital",description:"Vamos entender como trabalhar com as sa\xeddas Digitais",authors:"F\xe1bio Souza",date:"24/04/2021",some_url:"https://github.com/FBSeletronica"},r=void 0,t={id:"FranzininhoDIY/exemplos-avr-libc/saida-digital",title:"Sa\xedda Digital",description:"Vamos entender como trabalhar com as sa\xeddas Digitais",source:"@site/docs/FranzininhoDIY/exemplos-avr-libc/saida-digital.md",sourceDirName:"FranzininhoDIY/exemplos-avr-libc",slug:"/franzininho-diy/exemplos-avr-libc/saida-digital",permalink:"/docs/franzininho-diy/exemplos-avr-libc/saida-digital",draft:!1,unlisted:!1,editUrl:"https://github.com/Franzininho/docs-franzininho-site/edit/main/docs/FranzininhoDIY/exemplos-avr-libc/saida-digital.md",tags:[],version:"current",frontMatter:{id:"saida-digital",title:"Sa\xedda Digital",slug:"/franzininho-diy/exemplos-avr-libc/saida-digital",description:"Vamos entender como trabalhar com as sa\xeddas Digitais",authors:"F\xe1bio Souza",date:"24/04/2021",some_url:"https://github.com/FBSeletronica"},sidebar:"docs",previous:{title:"Hello, World!",permalink:"/docs/franzininho-diy/exemplos-avr-libc/hello-world"},next:{title:"Entrada Digital",permalink:"/docs/franzininho-diy/exemplos-avr-libc/entrada-digital"}},d={},c=[{value:"Recursos Necess\xe1rios",id:"recursos-necess\xe1rios",level:2},{value:"Pinos do ATtiny85",id:"pinos-do-attiny85",level:2},{value:"Algumas Particularidades do circuito da Franzininho DIY",id:"algumas-particularidades-do-circuito-da-franzininho-diy",level:3},{value:"Registradores respons\xe1veis pelos pinos de I/O",id:"registradores-respons\xe1veis-pelos-pinos-de-io",level:2},{value:"C\xf3digos",id:"c\xf3digos",level:2},{value:"Desafio",id:"desafio",level:2}];function l(e){const o={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.MN)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.p,{children:"Agora que j\xe1 estamos com as ferramentas instaladas e a placa Franzininho DIY em m\xe3os, vamos dar in\xedcio aos estudos dos perif\xe9ricos internos do ATtiny85."}),"\n",(0,s.jsx)(o.p,{children:"Nesse artigo vamos explorar os pinos de I/O como sa\xedda digital. Ao final, voc\xea saber\xe1 como acionar dispositivos externos a Franzininho DIY."}),"\n",(0,s.jsx)(o.h2,{id:"recursos-necess\xe1rios",children:"Recursos Necess\xe1rios"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:"Placa Franzininho DIY(com Micronucleus)"}),"\n",(0,s.jsx)(o.li,{children:"Computador com as ferramentas de software instaladas"}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"pinos-do-attiny85",children:"Pinos do ATtiny85"}),"\n",(0,s.jsx)(o.p,{children:"O ATtiny85 possui 8 pinos, sendo que 6 deles podemos usar como I/O (entradas ou sa\xeddas) digitais. Os pinos de I/O s\xe3o nomeados conforme a porta que eles pertencem. Na figura a seguir vemos que os pinos do ATtiny85 s\xe3o nomeados de PBx, onde x \xe9 o n\xfamero correspondente ao pino no registrador (n\xe3o se preocupe, vamos ver mais detalhes a seguir):"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{alt:"Pinagem do ATtiny85",src:i(42212).c+"",width:"2094",height:"498"})}),"\n",(0,s.jsx)(o.p,{children:"Cada pino de I/O pode ser usado como entrada ou sa\xedda e tamb\xe9m como outras fun\xe7\xf5es nesse momento s\xf3 vamos trabalhar com os pinos funcionando como GPIO (General Porpouse Input/Output)."}),"\n",(0,s.jsx)(o.p,{children:"Conforme exibido na imagem acima, temos os seguintes pinos dispon\xedveis no ATtiny85:"}),"\n",(0,s.jsx)(o.p,{children:"PB0, PB1, PB2, PB3, PB4, PB5."}),"\n",(0,s.jsx)(o.h3,{id:"algumas-particularidades-do-circuito-da-franzininho-diy",children:"Algumas Particularidades do circuito da Franzininho DIY"}),"\n",(0,s.jsx)(o.p,{children:"Os pinos de I/O s\xe3o marcados em Amarelo no Pinout da Franzininho DIY"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{alt:"pinout Franzininho DIY",src:i(12296).c+"",width:"1630",height:"1122"})}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:"O pino PB5 \xe9 configurado como RESET na Franzininho DIY, sendo assim n\xe3o poderemos us\xe1-lo como I/O."}),"\n",(0,s.jsx)(o.li,{children:"Os pinos PB3 e PB4 s\xe3o usados para o circuito da USB, sendo assim temos que us\xe1-los com cautela. Geralmente esses pinos s\xe3o usados apenas como sa\xeddas digitais."}),"\n",(0,s.jsx)(o.li,{children:"O LED amarelo da placa est\xe1 ligado ao pino PB1."}),"\n",(0,s.jsx)(o.li,{children:"Os pinos PB0 E PB2 n\xe3o possuem circuito ligados a eles."}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"registradores-respons\xe1veis-pelos-pinos-de-io",children:"Registradores respons\xe1veis pelos pinos de I/O"}),"\n",(0,s.jsx)(o.p,{children:"Para trabalhar com os pinos de I/O no ATtiny85 temos 3 registradores:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:"PORTB: Registrador de dados. Respons\xe1vel pela escrita nos pinos;"}),"\n",(0,s.jsx)(o.li,{children:"DDRB: Registrador de dire\xe7\xe3o do pino. Respons\xe1vel pela configura\xe7\xe3o dos pinos para definir se ser\xe1 entrada ou sa\xedda;"}),"\n",(0,s.jsx)(o.li,{children:"PINB: Registrador de entrada da porta. Respons\xe1vel pela leitura do estado do pino."}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:"Note que todos os registradores terminam com B no final. Isso significa que estamos trabalhando com o PORTB. Caso fosse um microcontrolador com maior quantidade de pinos ter\xedamos os finais A, B,C, etc. Cada porta s\xf3 possui no m\xe1ximo 8 pinos."}),"\n",(0,s.jsx)(o.p,{children:"Na se\xe7\xe3o 10 do datasheet do ATtiny85 temos todos os detalhes para se trabalhar com os I/O. A tabela a seguir, retirada do datasheet, exibe as configura\xe7\xf5es poss\xedveis para os pinos:"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{alt:"configura\xe7\xe3o GPIO",src:i(64516).c+"",width:"1194",height:"339"})}),"\n",(0,s.jsx)(o.p,{children:"A figura abaixo exibe os registradores respons\xe1veis pelos pino de I/O do PORTB:"}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.img,{alt:"configura\xe7\xe3o GPIO",src:i(59336).c+"",width:"1448",height:"696"})}),"\n",(0,s.jsx)(o.p,{children:"Note que cada bit dos registradores \xe9 respons\xe1vel por pino sendo indexado pelo n\xfamero correspondente ao bit. Dessa forma, se quisermos usar o pino PB1 para acionar o LED, devemos configurar o registrador DDRB da seguinte forma:"}),"\n",(0,s.jsxs)(o.table,{children:[(0,s.jsx)(o.thead,{children:(0,s.jsxs)(o.tr,{children:[(0,s.jsx)(o.th,{children:"7"}),(0,s.jsx)(o.th,{children:"6"}),(0,s.jsx)(o.th,{children:"5"}),(0,s.jsx)(o.th,{children:"4"}),(0,s.jsx)(o.th,{children:"3"}),(0,s.jsx)(o.th,{children:"2"}),(0,s.jsx)(o.th,{children:"1"}),(0,s.jsx)(o.th,{children:"0"})]})}),(0,s.jsx)(o.tbody,{children:(0,s.jsxs)(o.tr,{children:[(0,s.jsx)(o.td,{children:"-"}),(0,s.jsx)(o.td,{children:"-"}),(0,s.jsx)(o.td,{children:"0"}),(0,s.jsx)(o.td,{children:"0"}),(0,s.jsx)(o.td,{children:"0"}),(0,s.jsx)(o.td,{children:"0"}),(0,s.jsx)(o.td,{children:"1"}),(0,s.jsx)(o.td,{children:"0"})]})})]}),"\n",(0,s.jsx)(o.p,{children:"E para acionar ligar/deligar o LED devemos colocar 1 ou no bit correspondente no PORTB."}),"\n",(0,s.jsx)(o.p,{children:"Vamos a um exemplo para ficar mais claro."}),"\n",(0,s.jsx)(o.h2,{id:"c\xf3digos",children:"C\xf3digos"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-c",children:"#include <avr/io.h>\n#include <util/delay.h>\n\n#define F_CPU 16500000L        // Frequ\xeancia do oscilador. usado para a fun\xe7\xe3o de delay\n\nint main(void)\n{\n  DDRB = 0b00000010;           // Configura Pino PB1 como sa\xedda (Pino do LED)\n\n  while (1)\n  {\n      PORTB = 0b00000010;      // Liga o LED 1\n      _delay_ms(250);          // Aguarda 250 ms\n      PORTB = 0b00000000;      // Desliga o LED 1\n      _delay_ms(250);          // Aguarda 250 ms\n  }\n\n  return (0);\n}\n"})}),"\n",(0,s.jsx)(o.p,{children:"O exemplo acima pisca o LED em intervalos de 250 ms. A configura\xe7\xe3o do pino PB1 como sa\xedda foi feito colocando o bit1 de DDRB em 1. J\xe1 para ligar e desligar o LED foi manipulado o bit 1 de PORTB, hora em 1 hora em 0."}),"\n",(0,s.jsx)(o.p,{children:"Bacana, n\xe3o?"}),"\n",(0,s.jsxs)(o.p,{children:["podemos melhorar a manipula\xe7\xe3o dos bits dos registradores usando macros. As macros s\xe3o rotinas que facilitam nossas vidas. Recomendo que se voc\xea leia esse artigo para entender sobre as macros e as opera\xe7\xf5es efetuadas: ",(0,s.jsx)(o.a,{href:"https://www.embarcados.com.br/bits-em-linguagem-c/",children:"https://www.embarcados.com.br/bits-em-linguagem-c/"})]}),"\n",(0,s.jsx)(o.p,{children:"Vamos usar as seguintes macros:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{children:"#define setBit(valor,bit) (valor |= (1<<bit))\n#define toogleBit(valor,bit) (valor ^= (1<<bit))\n"})}),"\n",(0,s.jsx)(o.p,{children:"Os nomes j\xe1 s\xe3o auto-explicativos mas vamos verificar como us\xe1-las no programa em C:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-c",children:"#include <avr/io.h>\n#include <util/delay.h>\n\n#define F_CPU 16500000L\n\n// Macros\n#define setBit(valor,bit) (valor |= (1 << bit))\n#define toogleBit(valor,bit) (valor ^= (1 << bit))\n\nint main(void)\n{\n    setBit(DDRB,PB1);          // Configura Pino PB1 como sa\xedda (Pino do LED)\n\n    while (1)\n    {\n        toogleBit(PORTB, PB1); // Inverte o estado do pino\n        _delay_ms(250);        // Aguarda 250 ms\n    }\n\n    return (0);\n}\n"})}),"\n",(0,s.jsx)(o.p,{children:"Dessa forma manipulamos somente os bits desejados, n\xe3o alterando os valores dos outros que poder\xe3o ser usados para outras aplica\xe7\xf5es."}),"\n",(0,s.jsx)(o.h2,{id:"desafio",children:"Desafio"}),"\n",(0,s.jsx)(o.p,{children:"Coloque outro LED no pino PB0 e o acione alternadamente ao pino PB1, ou seja, quando LED no PB0 estiver ligado o LED em PB1 deve apagar e vice-versa."}),"\n",(0,s.jsxs)(o.table,{children:[(0,s.jsx)(o.thead,{children:(0,s.jsxs)(o.tr,{children:[(0,s.jsx)(o.th,{children:"Autor"}),(0,s.jsx)(o.th,{children:(0,s.jsx)(o.a,{href:"https://github.com/FBSeletronica",children:"F\xe1bio Souza"})})]})}),(0,s.jsx)(o.tbody,{children:(0,s.jsxs)(o.tr,{children:[(0,s.jsx)(o.td,{children:"Data:"}),(0,s.jsx)(o.td,{children:"24/04/2021"})]})})]})]})}function p(e={}){const{wrapper:o}={...(0,a.MN)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},95788:(e,o,i)=>{i.d(o,{MN:()=>c});var s=i(11504);function a(e,o,i){return o in e?Object.defineProperty(e,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[o]=i,e}function n(e,o){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);o&&(s=s.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),i.push.apply(i,s)}return i}function r(e){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?n(Object(i),!0).forEach((function(o){a(e,o,i[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))}))}return e}function t(e,o){if(null==e)return{};var i,s,a=function(e,o){if(null==e)return{};var i,s,a={},n=Object.keys(e);for(s=0;s<n.length;s++)i=n[s],o.indexOf(i)>=0||(a[i]=e[i]);return a}(e,o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)i=n[s],o.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}var d=s.createContext({}),c=function(e){var o=s.useContext(d),i=o;return e&&(i="function"==typeof e?e(o):r(r({},o),e)),i},l={inlineCode:"code",wrapper:function(e){var o=e.children;return s.createElement(s.Fragment,{},o)}},p=s.forwardRef((function(e,o){var i=e.components,a=e.mdxType,n=e.originalType,d=e.parentName,p=t(e,["components","mdxType","originalType","parentName"]),m=c(i),h=a,u=m["".concat(d,".").concat(h)]||m[h]||l[h]||n;return i?s.createElement(u,r(r({ref:o},p),{},{components:i})):s.createElement(u,r({ref:o},p))}));p.displayName="MDXCreateElement"},12296:(e,o,i)=>{i.d(o,{c:()=>s});const s=i.p+"assets/images/Pinagem-Franzininho-DIY-V2RV2-42a18903012c4dc223f9d4c774730625.png"},64516:(e,o,i)=>{i.d(o,{c:()=>s});const s=i.p+"assets/images/config-gpio-5448c58ddfc3c042b28c64b3cedb300e.png"},42212:(e,o,i)=>{i.d(o,{c:()=>s});const s=i.p+"assets/images/pinagem-attiny85-8fa815c3f3e21f9c3b699b09c9a7f6f1.png"},59336:(e,o,i)=>{i.d(o,{c:()=>s});const s=i.p+"assets/images/registradores-port-B-f8a36498e9dd1043ec81211a0fb7103c.png"}}]);