"use strict";(self.webpackChunkFranzininho=self.webpackChunkFranzininho||[]).push([[1392],{6567:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>d,contentTitle:()=>t,default:()=>c,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var i=n(17624),r=n(4552);const a={id:"timer0-int",title:"Timer 0 - Interrup\xe7\xe3o",slug:"/franzininho-diy/exemplos-avr-libc/timer0-int",description:"Vamos aprender usar o timer 0 como temporizador e usando sua interrup\xe7\xe3o",authors:"F\xe1bio Souza",date:"24/04/2021",some_url:"https://github.com/FBSeletronica"},t=void 0,s={id:"FranzininhoDIY/exemplos-avr-libc/timer0-int",title:"Timer 0 - Interrup\xe7\xe3o",description:"Vamos aprender usar o timer 0 como temporizador e usando sua interrup\xe7\xe3o",source:"@site/docs/FranzininhoDIY/exemplos-avr-libc/timer0-int.md",sourceDirName:"FranzininhoDIY/exemplos-avr-libc",slug:"/franzininho-diy/exemplos-avr-libc/timer0-int",permalink:"/docs/franzininho-diy/exemplos-avr-libc/timer0-int",draft:!1,unlisted:!1,editUrl:"https://github.com/Franzininho/docs-franzininho-site/edit/main/docs/FranzininhoDIY/exemplos-avr-libc/timer0-int.md",tags:[],version:"current",frontMatter:{id:"timer0-int",title:"Timer 0 - Interrup\xe7\xe3o",slug:"/franzininho-diy/exemplos-avr-libc/timer0-int",description:"Vamos aprender usar o timer 0 como temporizador e usando sua interrup\xe7\xe3o",authors:"F\xe1bio Souza",date:"24/04/2021",some_url:"https://github.com/FBSeletronica"},sidebar:"docs",previous:{title:"Timer 0",permalink:"/docs/franzininho-diy/exemplos-avr-libc/timer0"},next:{title:"Contador de pulsos externos",permalink:"/docs/franzininho-diy/exemplos-avr-libc/contadores"}},d={},l=[{value:"Interrup\xe7\xe3o do Timer0",id:"interrup\xe7\xe3o-do-timer0",level:2},{value:"Usando o Timer0 como temporizador com sua interrup\xe7\xe3o",id:"usando-o-timer0-como-temporizador-com-sua-interrup\xe7\xe3o",level:2},{value:"Recursos necess\xe1rios",id:"recursos-necess\xe1rios",level:3},{value:"C\xf3digo exemplo",id:"c\xf3digo-exemplo",level:3},{value:"Simula\xe7\xe3o do exemplo",id:"simula\xe7\xe3o-do-exemplo",level:3}];function m(e){const o={admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.p,{children:"Nesse exemplo vamos entender como usar a interrup\xe7\xe3o do Timer0 para verificar o seu overflow. Dessa forma n\xe3o precisaremos ficar monitorando o flag de overflow no loop principal da aplica\xe7\xe3o."}),"\n",(0,i.jsx)(o.h2,{id:"interrup\xe7\xe3o-do-timer0",children:"Interrup\xe7\xe3o do Timer0"}),"\n",(0,i.jsx)(o.p,{children:"No exemplo anterior configuramos o Timer0 para operar no modo  normal. Para monitora a sua contagem monitoramos o flag TOV0  dentro do loop. Como o Timer \xe9 um perif\xe9rico que funciona independente  da CPU podemos habilitar a sua contagem e verificar o overflow atrav\xe9s  da sua interrup\xe7\xe3o."}),"\n",(0,i.jsxs)(o.p,{children:["Para habilitar a interrup\xe7\xe3o do Timer0 devermos colocar 1 no bit ",(0,i.jsx)(o.strong,{children:"TOIE0"})," no registrador ",(0,i.jsx)(o.strong,{children:"TIMSK"}),":"]}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.img,{alt:"TIMSK",src:n(62336).c+"",width:"836",height:"158"})}),"\n",(0,i.jsx)(o.p,{children:"Ap\xf3s isso, para que a interrup\xe7\xe3o realmente ocorra, devemos habilitar a chave global de interrup\xe7\xe3o atrav\xe9s da fun\xe7\xe3o sei();"}),"\n",(0,i.jsx)(o.h2,{id:"usando-o-timer0-como-temporizador-com-sua-interrup\xe7\xe3o",children:"Usando o Timer0 como temporizador com sua interrup\xe7\xe3o"}),"\n",(0,i.jsx)(o.p,{children:"Vamos  fazer a mesma aplica\xe7\xe3o do exemplo anterior, que \xe9 inverter o estado lo  LED em intervalos de 1 s. A diferen\xe7a aqui \xe9 que vamos monitorar os  overflows do timer atrav\xe9s da rotina de interrup\xe7\xe3o."}),"\n",(0,i.jsx)(o.p,{children:"A configura\xe7\xe3o do timer segue a mesma, j\xe1 que queremos gerar um delay de 1 segundo."}),"\n",(0,i.jsx)(o.p,{children:"Assim, precisaremos contar a quantidade de interrup\xe7\xf5es e quando atingir 63, inverteremos o estado do LED."}),"\n",(0,i.jsx)(o.h3,{id:"recursos-necess\xe1rios",children:"Recursos necess\xe1rios"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"Placa Franzininho DIY(com Micronucleus);"}),"\n",(0,i.jsx)(o.li,{children:"LED;"}),"\n",(0,i.jsx)(o.li,{children:"Resistor de 470 Ohm;"}),"\n",(0,i.jsx)(o.li,{children:"Jumpers;"}),"\n",(0,i.jsx)(o.li,{children:"Computador com as ferramentas de software instaladas."}),"\n"]}),"\n",(0,i.jsx)(o.h3,{id:"c\xf3digo-exemplo",children:"C\xf3digo exemplo"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-c",children:'/**\n * \n * @file main.c\n * @author F\xe1bio Souza\n * @brief Exibe como usar a interrup\xe7\xe3o do timer 0 para temporiza\xe7\xe3o\n * @version 0.1\n * @date 2021-02-13\n * \n * @copyright Franzininho \n * This example code is in the Public Domain (or CC0 licensed, at your option.)\n * Unless required by applicable law or agreed to in writing, this\n * software is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied.\n * \n */\n\n#include <avr/io.h>\n#include <util/delay.h> \n#include <avr/interrupt.h>\n\n#define F_CPU 16500000L\n\n \t\n#define setBit(valor,bit) (valor |= (1<<bit))\n#define clearBit(valor,bit) (valor &= ~(1<<bit))\n#define toogleBit(valor,bit) (valor ^= (1<<bit))\n#define testBit(valor,bit)    (valor & (1<<bit))\n\nunsigned char tempo = 0;  //contador auxiliar\n\n\nISR (TIMER0_OVF_vect) //vetor de interrup\xe7\xe3o para o timer 0\n{\n  tempo++;                     //incrementa contador auxiliar\n  if(tempo >=63)               //se passaram-se 63 x 15,89 ms = 1 s\n  {\n    toogleBit(PORTB,PB1);      //inverte LED\n    tempo = 0;                 //reinicia contador\n  }\n}\n\n/**\n * @brief Fun\xe7\xe3o main\n * \n * @return int \n */\nint main(void) \n{\n  \n  setBit(DDRB,PB1); \t// Configura Pino PB1 como sa\xedda (Pino do LED)\n\n  //configura\xe7\xe3o do timer0 para overflow a aproximadamente 15,89 ms\n  //t = (1/16.5Mhz) x 1024 x 256 = 15,89 ms\n  TCCR0A=0x00;                      //Modo Normal\n  TCCR0B=0x00;\n  TCCR0B |= (1<<CS00)|(1<<CS02);   //prescaler de 1024\n  TCNT0=0;                         //inicia timer com 0\n  setBit(TIMSK,TOIE0);             //habilita interrup\xe7\xe3o do timer0 \n  sei();                           //habilita interrup\xe7\xe3o global\n  \n  /**\n   * @brief loop infinito\n   * \n   */\n  while (1)\n  {\n      //n\xe3o faz nada no loop \n  }                                                \n  return (0);                           \n}\n'})}),"\n",(0,i.jsx)(o.admonition,{title:"Informa\xe7\xe3o",type:"note",children:(0,i.jsx)(o.p,{children:"Note que no loop principal n\xe3o fizemos nada. Todo o tratamento ficou na interrup\xe7\xe3o do Timer0."})}),"\n",(0,i.jsx)(o.h3,{id:"simula\xe7\xe3o-do-exemplo",children:"Simula\xe7\xe3o do exemplo"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"**Wokwi: **"}),"\n"]}),"\n",(0,i.jsx)("iframe",{width:"100%",height:"458px",src:"https://wokwi.com/arduino/projects/306143631949955648?view=diagram"})]})}function c(e={}){const{wrapper:o}={...(0,r.M)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}},62336:(e,o,n)=>{n.d(o,{c:()=>i});const i=n.p+"assets/images/TIMSK-a059550570192a069297e5ea900b71ef.png"},4552:(e,o,n)=>{n.d(o,{I:()=>s,M:()=>t});var i=n(11504);const r={},a=i.createContext(r);function t(e){const o=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(a.Provider,{value:o},e.children)}}}]);