<!doctype html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/docs-franzininho-site/blog/rss.xml" title="Franzininho Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs-franzininho-site/blog/atom.xml" title="Franzininho Blog Atom Feed"><title data-react-helmet="true">Contador de pulsos externos | Franzininho</title><meta data-react-helmet="true" property="og:image" content="https://franzininho.github.io/docs-franzininho-site/img/logo.svg"><meta data-react-helmet="true" name="twitter:image" content="https://franzininho.github.io/docs-franzininho-site/img/logo.svg"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Franzininho"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="pt-BR"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:image:width" content="1200"><meta data-react-helmet="true" property="og:image:height" content="630"><meta data-react-helmet="true" property="og:title" content="Contador de pulsos externos | Franzininho"><meta data-react-helmet="true" name="description" content="Nesses três exemplos vamos explorar gradativamente como fazer um contador de eventos externos no Franzininho DIY"><meta data-react-helmet="true" property="og:description" content="Nesses três exemplos vamos explorar gradativamente como fazer um contador de eventos externos no Franzininho DIY"><meta data-react-helmet="true" property="og:url" content="https://franzininho.github.io/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/contadores"><link data-react-helmet="true" rel="shortcut icon" href="/docs-franzininho-site/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://franzininho.github.io/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/contadores"><link rel="stylesheet" href="/docs-franzininho-site/styles.f5da77b5.css">
<link rel="preload" href="/docs-franzininho-site/styles.c96bf6ad.js" as="script">
<link rel="preload" href="/docs-franzininho-site/runtime~main.bc25378d.js" as="script">
<link rel="preload" href="/docs-franzininho-site/main.aacac02e.js" as="script">
<link rel="preload" href="/docs-franzininho-site/1.b46109e3.js" as="script">
<link rel="preload" href="/docs-franzininho-site/85.d5907508.js" as="script">
<link rel="preload" href="/docs-franzininho-site/86.2558c8d1.js" as="script">
<link rel="preload" href="/docs-franzininho-site/935f2afb.ecd839a2.js" as="script">
<link rel="preload" href="/docs-franzininho-site/84.bdd58f0d.js" as="script">
<link rel="preload" href="/docs-franzininho-site/bdb4d3e5.72d49abe.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/docs-franzininho-site/"><img src="/docs-franzininho-site/img/logo.svg" alt="Logo do site" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/docs-franzininho-site/img/logo.svg" alt="Logo do site" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Franzininho</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-franzininho-site/docs">Documentação</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">Português (Brasil)</a><ul class="dropdown__menu"><li><a href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/contadores" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">Português (Brasil)</a></li><li><a href="/docs-franzininho-site/en/docs/franzininho-diy/exemplos-avr-libc/contadores" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li></ul></div><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docs-franzininho-site/"><img src="/docs-franzininho-site/img/logo.svg" alt="Logo do site" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/docs-franzininho-site/img/logo.svg" alt="Logo do site" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Franzininho</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs-franzininho-site/docs">Documentação</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">Languages</a><ul class="menu__list"><li class="menu__list-item"><a href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/contadores" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active">Português (Brasil)</a></li><li class="menu__list-item"><a href="/docs-franzininho-site/en/docs/franzininho-diy/exemplos-avr-libc/contadores" target="_self" rel="noopener noreferrer" class="menu__link">English</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Comece aqui</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/">Seja bem vindo!</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Franzininho DIY</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/sobre">Placa Franzininho DIY</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Montagem</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/lista-de-materiais">Lista de Materiais</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/identificando-componentes">Identificando os componentes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/montagem">Montagem da Franzininho DIY</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Bootloader</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/bootloader">Bootloader</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/drivers-micronucleus">Instalação de drivers e configuração da USB</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Exemplos Arduino</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/pacote">Configuração da Arduino IDE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/entradas-saidas-digitais">Entradas e Saídas Digitais</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/entradas-analogicas">Entradas Analógicas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/saidas-pwm">Saídas PWM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/pisca-led">Pisca LED</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/brilho-led">Controle brilho de LED</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/leitura-tecla">Leitura de Tecla</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/tecla-liga-desliga">Tecla Liga/Desliga</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/led-rgb">LED RGB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/elefante-colorido">Elefante Colorido! Que cor?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/sensor-luz-ldr">Sensor de luz com LDR</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/semaforo">Semáforo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/theremim">Theremim</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Exemplos AVR Libc</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/primeiros-passos">Primeiros Passos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/hello-world">Hello, World!</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/saida-digital">Saída Digital</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/entrada-digital">Entrada Digital</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/timer0">Timer 0</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/timer0-int">Timer 0 - Interrupção</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/contadores">Contador de pulsos externos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/buzzer">Instrumento musical com Buzzer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/todo">TODO</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Simulador Wokwi</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/wokwi/primeiros-passos">Como simular a Franzininho DIY no Wokwi</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Simulador PICSimLab</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-diy/picsimlab/primeiros-passos">Franzininho DIY no PICSimLab</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Franzininho WiFi</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/franzininho-wifi">Placa Franzininho WiFi</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ESP-IDF</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-espidf/primeiros-passos">Primeiros Passos com ESP-IDF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-espidf/hello-world-esp-idf">Hello World! ESP-IDF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-espidf/entrada-digital">Entrada digital</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-espidf/entrada-analogica">Entrada Analógica</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-espidf/ledc">PWM com LEDC</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">CircuitPython</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/primeiros-passos">Primeiros Passos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/ferramentas">Instalando as ferramentas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/hello-world">Hello World!</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/serial-console">Serial Console</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/entradas-saidas-digitais">Entradas e Saídas Digitais</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/entradas-analogicas">Entrada Analógica</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/display-oled-i2c">Display OLED I2C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/dht11">Sensor de temperatura e umidade DHT11</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-circuitpython/sensor-hcsr04">Sensor de Distância Ultrassônico HC-SR04</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Arduino</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-arduino/primeiros-passos">Primeiros Passos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-arduino/blink">Blink</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-arduino/neopixel-onboard">Neopixel RGB LED Onboard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-wifi/exemplos-arduino/dht11">Leitura DHT11</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FranzMakey</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/FranzMakey/franzmakey">Placa FranzMakey</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/FranzMakey/primeiros-passos">Primeiros Passos</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Franzininho Tiny</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/franzininho-tiny/franzininho-tiny">Placa Franzininho Tiny</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Franzino</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/Franzino/franzino">Placa Franzino</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/Franzino/upload-conversor-serial">Upload via conversor USB/SERIAL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/Franzino/upload-com-arduino-uno">Gravando a Franzino com um placa Arduino UNO</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FranzBoy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/FranzBoy/franzboy">Placa FranzBoy</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Badges</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs-franzininho-site/docs/badge/badge">Badge - Aprenda a soldar</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Contador de pulsos externos</h1></header><div class="markdown"><p>Nesses três exemplos vamos explorar gradativamente como fazer um contador de eventos externos no Franzininho DIY. Vamos explorar as formas mais simples e as mais complexas de contar eventos e as vantagens de cada uma. Nesses exemplos vamos aprender a usar o timer e a fazer debounce, necessário para lermos apenas eventos válidos e não ler o mesmo evento mais de uma vez.</p><p>Boa prática!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="recursos-necessários"></a><strong>Recursos necessários</strong><a class="hash-link" href="#recursos-necessários" title="Direct link to heading">#</a></h2><ul><li>Franzininho DIY (com Micronucleos)</li><li>4 LEDs de 3mm</li><li>4 resistores de 200Ω</li><li>1 resistor de 10kΩ</li><li>1 chave tactil</li><li>7 jumpers macho-fêmea</li><li>7 jumpers macho-macho</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="contadores"></a><strong>Contadores</strong><a class="hash-link" href="#contadores" title="Direct link to heading">#</a></h2><p>Temos três exemplos de contadores da versão 1 a 3, e aumentando a complexidade do código e dos recursos utilizados.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="contador_v1"></a><strong>Contador_v1</strong><a class="hash-link" href="#contador_v1" title="Direct link to heading">#</a></h3><p>Nesse exemplo vamos utilizar loops para fazer a verificação de eventos. Essa forma de se fazer a contagem, apesar de ser mais simples de se entender e criar, é pouco eficiente, tanto a nível de processamento, quanto ao de energia.</p><p>O programa é um código em linguagem C e faz uso dos nomes dos registradores definidos na biblioteca <code>avr/io.h</code>. Para melhor entendimento recomendo ler os comentários do código e o datasheet do ATtiny85.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="código"></a><strong>Código</strong><a class="hash-link" href="#código" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @file main.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @author Eduardo Dueñas</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @brief Exemplo de contador de eventos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @version 1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @date 06/04/2021</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * última modificação: 05/05/2021</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&lt;avr/io.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> F_CPU 16500000L        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Frequência de CLK</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Macros</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> setBit(valor,bit)      (valor |= (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> clearBit(valor,bit)    (valor &amp;= ~(1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> toogleBit(valor,bit)   (valor ^= (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> testBit(valor,bit)     (valor &amp; (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Debounce da chave táctil para desconsiderarmos ruído e bouncing do botão</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">char</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">debounce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> pino</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Testa o pino várias vezes para evitar leituras erradas</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">testBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PINB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> pino</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Testa se o pino deixou de ser 1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Se sim, retorna falso</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Retorna verdadeiro</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configuração de PORTB</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB0 como entrada</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB1 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB2 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB3 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB4 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xE1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda 0 para PB[4:1]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">char</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">                    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// loop infinito</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">testBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PINB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Testa se PB0 é 1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">debounce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PB0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Verifica se realmente foi um aperto de botão</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              count</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Se sim, incrementa o contador</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token keyword" style="font-style:italic">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">testBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PINB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Espera o botão parar de ser pressionado</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        count </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Limpa o overflow do contador</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xE1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">count </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda o contador para PB[4:1]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="montagem"></a><strong>Montagem</strong><a class="hash-link" href="#montagem" title="Direct link to heading">#</a></h4><p><img alt="circuito contador" src="/docs-franzininho-site/assets/images/Exemplo_Contador_Circuito-a726ec616f1978417fe735405b5dadd9.png"></p><p>Como mostrado na imagem, os LEDs são ligados nas saídas PortB[4:1] e o botão no PortB[0].</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="compilação-e-upload"></a><strong>Compilação e upload</strong><a class="hash-link" href="#compilação-e-upload" title="Direct link to heading">#</a></h4><p>Para compilar o programa, assim como nos programas anteriores, acesse a pasta do exemplo e em seguida o comando <code>make</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">exemplos-avr-libc/exemplos/contador$ make</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Como já temos o makerfile configurado na pasta, será feita compilação e deve aparecer a seguinte mensagem:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">../../micronucleus/2.0a4/launcher  -cdigispark --timeout 60 -Uflash:w:main.hex:i</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Running Digispark Uploader...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Plug in device now... (will timeout in 60 seconds)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; Please plug in the device (will time out in 60 seconds) ...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Conecte a placa em uma entrada USB ou, caso a Franzininho já esteja conectada, aperte o botão de reset para iniciar o upload.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="resultado"></a><strong>Resultado</strong><a class="hash-link" href="#resultado" title="Direct link to heading">#</a></h4><p>Os LEDs devem mostrar a contagem de apertos do botão de forma binária resetando em 0x10 ou quando resetada a placa.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="análise"></a><strong>Análise</strong><a class="hash-link" href="#análise" title="Direct link to heading">#</a></h4><p>Esse código é de simples compreensão usando apenas um <code>for</code> para checar continuamente se o botão foi apertado, chamando uma função debounce caso a leitura seja 1, incrementando o contador se for confirmado que a leitura é válida, esperando  o botão ser solto e mandando o valor para as saídas.</p><p>De forma geral esse código funciona, mas há muito desperdício de processamento, pois há muitos momentos que o processador não está fazendo nada, apenas esperando algo acontecer ou um certo tempo passar, nesse tempo ele poderia estar fazendo outra tarefas ou ficar em modo econômico de energia, que veremos nos próximos exemplos.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="contador_v2"></a><strong>Contador_v2</strong><a class="hash-link" href="#contador_v2" title="Direct link to heading">#</a></h3><p>Nesse exemplo vamos começar a usar interrupções para ler os pulsos. Vamos ver quais são as vantagens desse método e o que pode ser melhorado.</p><p>O programa é um código em linguagem C e faz uso dos nomes dos registradores definidos na biblioteca <code>avr/io.h</code> e a biblioteca <code>avr/interrupt.h</code>. Para melhor entendimento recomendo ler os comentários do código e o datasheet do ATtiny85.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="código-1"></a><strong>Código</strong><a class="hash-link" href="#código-1" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @file main.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @author Eduardo Dueñas</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @brief Exemplo de contador de eventos com tratamento por interrupção</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @version 1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @date 19/04/2021</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * última modificação: 05/05/2021</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * O programa é um desenvolvimento em cima do contador uma com alterações na leitura do pulso para leitura por interrupção,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * possibilitando o uso do microcontrolador para outras funções junto do contador</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&lt;avr/io.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&lt;avr/interrupt.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> F_CPU 16500000L        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Frequência de CLK</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Macros</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> setBit(valor,bit)      (valor |= (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> clearBit(valor,bit)    (valor &amp;= ~(1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> toogleBit(valor,bit)   (valor ^= (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> testBit(valor,bit)     (valor &amp; (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">volatile</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">char</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Contador</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ISR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">INT0_vect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">cli</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Desabilita interrupções globais durante o tratamento da interrupção</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">debounce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PB2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Se o botão foi realmente apertado incrementa cont e manda para os LEDs</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    count</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Incrementa o contador</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    count </span><span class="token operator" style="color:rgb(137, 221, 255)">%=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Limpa o excesso</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xE7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">count </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda os dois bits mais significativos de cont para PB[4:3]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xFC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">count </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x03</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda os dois bits menos significativos de cont para PB[1:0]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">sei</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Reabilita interrupções globais</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Debounce da chave tactil para desconsiderarmos ruído e bouncing do botão</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">char</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">debounce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> pino</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Testa o pino várias vezes para evitar leituras erradas</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">testBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PINB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> pino</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Testa se o pino deixou de ser 1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Se sim, retorna falso</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Retorna verdadeiro</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configuração de PORTB</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB2 como entrada</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB0 como saída</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB1 como saída</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB3 como saída</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB4 como saída</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xE4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda 0 para PB[4:3] e PB[1:0]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Configuração de Interrupção externa</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    GIMSK </span><span class="token operator" style="color:rgb(137, 221, 255)">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> INT0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Habilita interrupções externas no INT0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    MCUCR </span><span class="token operator" style="color:rgb(137, 221, 255)">|=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x03</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Seta interrupções para borda de subida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">sei</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Habilita interrupções globais</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">                 </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Loop infinito</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Aqui você pode colocar outra aplicação para rodar simultaneamente ao contador</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="montagem-1"></a><strong>Montagem</strong><a class="hash-link" href="#montagem-1" title="Direct link to heading">#</a></h4><p><img alt="Circuito contador V2" src="/docs-franzininho-site/assets/images/Exemplo_Contador_Circuito_v2-cb27b793816afd0d2a3b33b95b9e734f.png"></p><p>Como mostrado na imagem, os LEDs são ligados nas saídas PORTB[4:3] e [1:0] e o botão na entrada PORTB[2].</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="compilação-e-upload-1"></a><strong>Compilação e upload</strong><a class="hash-link" href="#compilação-e-upload-1" title="Direct link to heading">#</a></h4><p>Para compilar o programa, assim como nos programas anteriores, acesse a pasta do exemplo e em seguida o comando <code>make</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">exemplos-avr-libc/exemplos/contador_v2$ make</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Como já temos o makerfile configurado na pasta, será feita compilação e deve aparecer a seguinte mensagem:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">../../micronucleus/2.0a4/launcher  -cdigispark --timeout 60 -Uflash:w:main.hex:i</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Running Digispark Uploader...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Plug in device now... (will timeout in 60 seconds)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; Please plug in the device (will time out in 60 seconds) ...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Conecte a placa em uma entrada USB ou, caso a Franzininho já esteja conectada, aperte o botão de reset para iniciar o upload.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="resultado-1"></a><strong>Resultado</strong><a class="hash-link" href="#resultado-1" title="Direct link to heading">#</a></h4><p>Assim como no último exemplo, os LEDs devem mostrar a contagem de eventos, mostrando em binário até 15.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="análise-1"></a><strong>Análise</strong><a class="hash-link" href="#análise-1" title="Direct link to heading">#</a></h4><p>Esse exemplo tem um código um pouco mais complexo, podendo fazer diferentes tarefas ao mesmo tempo com o uso de interrupções.</p><p>Interrupções são, de forma simples, instruções de alta prioridade, que fazem o processador parar o que está fazendo, guardar o estado atual, executar as instruções da interrupção e voltar para o estado anterior, continuando normalmente com o programa. Elas são extremamente úteis para tarefas que precisam de uma precisão de tempo alta ou eventos assíncronos.</p><p>Porém, apesar do exemplo dois fazer uso de interrupções, ele passa muito tempo nela, o que atrasa o andamento de um possível outro programa que estaria rodando na <code>main</code>. Porém, grande parte do tempo que é gasto na interrupção está atrelado ao debounce, que consiste basicamente de checagens em certos períodos de tempo. Podemos então otimizar o uso do processador saindo da interrupção entre as checagens, uma vez que ele está apenas esperando para fazer o próximo teste. Veremos isso e o modo de economia de energia no contador_v3.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="contador_v3"></a><strong>Contador_v3</strong><a class="hash-link" href="#contador_v3" title="Direct link to heading">#</a></h3><p>Nesse exemplo vamos otimizar o processamento no código utilizando interrupções para as esperas do debounce, também veremos uma alternativa para diminuir o consumo de energia em momentos em que o processador está esperando algum evento, caso você não precise de outra rotina.</p><p>Esse programa é um código em linguagem C e faz uso dos nomes dos registradores definidos na biblioteca <code>avr/io.h</code> e a biblioteca <code>avr/interrupt.h</code>. Para melhor entendimento recomendo ler os comentários do código e o datasheet do ATtiny85.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="código-2"></a><strong>Código</strong><a class="hash-link" href="#código-2" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @file main.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @author Eduardo Dueñas</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @brief Exemplo de contador de eventos com tratamento por interrupção</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @version 1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @date 20/04/2021</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * última modificação: 05/05/2021</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * O programa é um desenvolvimento em cima do contador_v2 uma com alterações no loop infinito que</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * havia ficado em aberto para outras aplicações para o modo sleep para diminuir o gasto de energia e</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * alterar o debounce para interrupção, aumentando a eficiência do código. O código pode ser usado com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * outras aplicações no lugar do sleep.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&lt;avr/io.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&lt;avr/interrupt.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&lt;avr/sleep.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> F_CPU 16500000L        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Frequência de CLK</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> setBit(valor,bit)      (valor |= (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> clearBit(valor,bit)    (valor &amp;= ~(1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> toogleBit(valor,bit)   (valor ^= (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> testBit(valor,bit)     (valor &amp; (1 &lt;&lt; bit))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">volatile</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">char</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Contador</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">volatile</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">char</span><span class="token plain"> test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Quantidade de testes do debounce</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Pino do debounce</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Debounce da chave tactil para desconsiderarmos ruido e bouncing do botão</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">char</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">debounce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> pino</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> pino</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Coloca um timer para cada 1000 ciclos de clk para testar a chave tactil</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    TCNT0 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">131</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">               </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Overflow-(ciclos/Prescaler)=256-(1000/8)=131</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIMSK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TOIE0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Habilita interrupções por timer overflow</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Limpa test</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ISR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">INT0_vect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">               </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Tratamento de interrupções de pulso externo</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">GIMSK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> INT0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Desabilita interrupções do INT0 durante o tratamento da interrupção</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">debounce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PB2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ISR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIMER0_OVF_vect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Tratamento de interrupções de timer overflow</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    TCNT0 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">131</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">               </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Seta denovo o timer para 131</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">testBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PINB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> pin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Se o botão continua apertado</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        test</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Incrementa test</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Se testou o suficiente (no caso 20 vezes)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            count</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">           </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Incrementa o contador</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            count </span><span class="token operator" style="color:rgb(137, 221, 255)">%=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Limpa o excesso</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xE7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">count </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda os dois bits mais significativos de cont para PB[4:3]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xFC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">count </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x03</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda os dois bits menos significativos de cont para PB[1:0]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIMSK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TOIE0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Desabilita interrupções por timer overflow</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">GIMSK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> INT0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Reabilita interrupções externas no INT0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIMSK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TOIE0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Desabilita interrupções por timer overflow</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">GIMSK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> INT0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Reabilita interrupções externas no INT0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configuração de PORTB</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB2 como entrada</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB0 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB1 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB3 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DDRB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PB4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura PB4 como saida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PORTB </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xE4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Manda 0 para PB[4:3] e PB[1:0]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configuração do timer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    TCCR0A </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Modo Normal</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    TCCR0B </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    TCCR0B </span><span class="token operator" style="color:rgb(137, 221, 255)">|=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x02</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Prescaler de 8</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configuração do modo sleep</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">MCUCR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> SM0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configura sleep mode como idle</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">clearBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">MCUCR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> SM1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Configuração de Interrupção externa</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setBit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">GIMSK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> INT0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Habilita interrupções externas no INT0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    MCUCR </span><span class="token operator" style="color:rgb(137, 221, 255)">|=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x03</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Seta interrupções para borda de subida</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">sei</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">                     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Habilita interrupções globais</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">                 </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Loop infinito</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Aqui você pode colocar outra aplicação para rodar simultaneamente ao contador no lugar do sleep</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">sleep_mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Entra no sleep mode</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="montagem-2"></a><strong>Montagem</strong><a class="hash-link" href="#montagem-2" title="Direct link to heading">#</a></h4><p><img alt="Circuito contador V3" src="/docs-franzininho-site/assets/images/Exemplo_Contador_Circuito_v3-cb27b793816afd0d2a3b33b95b9e734f.png"></p><p>Como mostrado na imagem, os LEDs são ligados nas saídas PORTB[4:3] e [1:0] e o botão na entrada PORTB[2], assim como no exemplo dois.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="compilação-e-upload-2"></a><strong>Compilação e upload</strong><a class="hash-link" href="#compilação-e-upload-2" title="Direct link to heading">#</a></h4><p>Para compilar o programa, assim como nos programas anteriores, acesse a pasta do exemplo e em seguida o comando <code>make</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">exemplos-avr-libc/exemplos/contador_v3$ make</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Como já temos o makerfile configurado na pasta, será feita compilação e deve aparecer a seguinte mensagem:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">../../micronucleus/2.0a4/launcher  -cdigispark --timeout 60 -Uflash:w:main.hex:i</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Running Digispark Uploader...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Plug in device now... (will timeout in 60 seconds)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; Please plug in the device (will time out in 60 seconds) ...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Conecte a placa em uma entrada USB ou, caso a Franzininho já esteja conectada, aperte o botão de reset para iniciar o upload.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="resultado-2"></a><strong>Resultado</strong><a class="hash-link" href="#resultado-2" title="Direct link to heading">#</a></h4><p>Assim como nos exemplos anteriores, os LEDs do circuito devem mostrar a contagem de pulsos até 15 em binário.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="análise-2"></a><strong>Análise</strong><a class="hash-link" href="#análise-2" title="Direct link to heading">#</a></h4><p>Neste código adicionamos um pouco mais de complexidade, aumentando o uso de interrupções, além do uso do timer e do modo Sleep.</p><p>O modo Sleep é um mode de operação no qual, de forma básica, se desliga alguns módulos do microcontrolador até que alguma interrupção ocorra, o que pode diminuir o consumo de energia de forma drástica. No caso do código do exemplo, utilizamos o modo Idle que no ATtiny85 desliga os CLKs da CPU e FLASH, podendo se desligar opcionalmente o CLK do ADC.</p><p>O timer nesse exemplo está configurado como em modo normal, com prescaler de 8, o que faz ele incrementar o timer uma vez a cada 8 ciclos de CLK. A forma adotada para a contagem do tempo foi a interrupção por timer overflow, ou seja, sempre que o valor máximo do timer for atingido ele gera uma interrupção. Para conseguirmos os 1000 ciclos que queremos calculamos <code>overflow -(ciclos/Prescaler)</code>, que nos dá <code>256 -(1000/8) = 131</code>, e setamos o valor do timer nesse valor para que falte o tempo que desejamos para a interrupção.</p><p>O uso de interrupções do timer para o debounce diminui consideravelmente o tempo que o processador consome em execução do tratamento do evento, o que melhora o processamento das rotinas paralelas, ou no caso, permite que o processador fique mais tempo no modo Sleep, diminuindo o consumo de energia ou em caso de alimentação por baterias, aumenta a vida útil da da fonte.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="conclusão"></a><strong>Conclusão</strong><a class="hash-link" href="#conclusão" title="Direct link to heading">#</a></h2><p>De forma geral, todas as três formas de se fazer o código funcionam, e ao servirem seu propósito não estão erradas. Porém, como programadores, principalmente de sistemas embarcados, é uma ótima prática conseguirmos fazer um código eficiente, de forma a não se tornar um empecilho no futuro, seja por usarmos muita memória ou deixarmos o processador muito lento e termos que refazer algo pronto do zero. Por isso é importante saber quais são as vantagens e desvantagens de cada método para podermos sempre utilizar o que melhor se adequa às nossas necessidades.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="glossário"></a>Glossário<a class="hash-link" href="#glossário" title="Direct link to heading">#</a></h2><ul><li>Setar: colocar um novo valor em um registrador. Para um bit é convencionado setar, muda-lo para valor 1, e clear (limpar), muda-lo para valor 0</li><li>Chave tactil/Push button: botão</li><li>Debounce: correção do efeito de bouncing (efeito que ocorre em chaves que fazem rápidas conexões e desconexões antes de se estabilizar)</li><li>Resetar: reiniciar</li><li>Timer: circuito eletrônico dedicado a contagem de tempo</li></ul><table><thead><tr><th>Autor</th><th><a href="https://github.com/EduardoDuenas" target="_blank" rel="noopener noreferrer">Eduardo Dueñas</a></th></tr></thead><tbody><tr><td>Data:</td><td>05/05/2020</td></tr></tbody></table></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Franzininho/docs-franzininho-site/edit/main/docs/FranzininhoDIY/exemplos-avr-libc/contadores.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/timer0-int"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Timer 0 - Interrupção</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-franzininho-site/docs/franzininho-diy/exemplos-avr-libc/buzzer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Instrumento musical com Buzzer »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#recursos-necessários" class="table-of-contents__link"><strong>Recursos necessários</strong></a></li><li><a href="#contadores" class="table-of-contents__link"><strong>Contadores</strong></a><ul><li><a href="#contador_v1" class="table-of-contents__link"><strong>Contador_v1</strong></a></li><li><a href="#contador_v2" class="table-of-contents__link"><strong>Contador_v2</strong></a></li><li><a href="#contador_v3" class="table-of-contents__link"><strong>Contador_v3</strong></a></li></ul></li><li><a href="#conclusão" class="table-of-contents__link"><strong>Conclusão</strong></a></li><li><a href="#glossário" class="table-of-contents__link">Glossário</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Documentação</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs-franzininho-site/docs/">Projeto</a></li><li class="footer__item"><a class="footer__link-item" href="/docs-franzininho-site/docs/badge/badge">Badge</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Comunidade</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/H5kENmWGaz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://www.facebook.com/groups/299236843857849/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Grupo no Facebook</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Redes Sociais</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.instagram.com/franzininho/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram</a></li><li class="footer__item"><a href="https://facebook.com/franzininho/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCxyabOm4teS0kx0EgJW78_g" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Mais</h4><ul class="footer__items"><li class="footer__item"><a href="https://franzininho.com.br/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Site</a></li><li class="footer__item"><a href="https://github.com/franzininho" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="mailto:contato@franzininho.com.br" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contato</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Franzininho. Construído com Docusaurus.</div></div></div></footer></div>
<script src="/docs-franzininho-site/styles.c96bf6ad.js"></script>
<script src="/docs-franzininho-site/runtime~main.bc25378d.js"></script>
<script src="/docs-franzininho-site/main.aacac02e.js"></script>
<script src="/docs-franzininho-site/1.b46109e3.js"></script>
<script src="/docs-franzininho-site/85.d5907508.js"></script>
<script src="/docs-franzininho-site/86.2558c8d1.js"></script>
<script src="/docs-franzininho-site/935f2afb.ecd839a2.js"></script>
<script src="/docs-franzininho-site/84.bdd58f0d.js"></script>
<script src="/docs-franzininho-site/bdb4d3e5.72d49abe.js"></script>
</body>
</html>